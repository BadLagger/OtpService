CREATE TABLE IF NOT EXISTS Users(
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    login VARCHAR(255) NOT NULL UNIQUE,
    passwd TEXT,
    role VARCHAR(20) CHECK (role IN ('ADMIN', 'USER')),
    telegram TEXT UNIQUE,
    email TEXT UNIQUE,
    phone TEXT UNIQUE
);

CREATE TABLE IF NOT EXISTS OtpConfig(
    lifetime INTEGER NOT NULL CHECK(lifetime >= 0),
    sign_number INTEGER NOT NULL CHECK(sign_number >= 5)
);

CREATE TABLE IF NOT EXISTS OtpCodes(
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    code VARCHAR(255) NOT NULL,
    status VARCHAR(20) CHECK (status IN ('ACTIVE', 'EXPIRED', 'USED')),
    operation_id INTEGER NOT NULL CHECK(operation_id >= 0)
);